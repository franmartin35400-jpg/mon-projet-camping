<!DOCTYPE html>
<html lang="fr" data-theme="">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Accueil â€“ Camping de Rivassland</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{--glass:rgba(255,255,255,.56);--glass-strong:rgba(255,255,255,.70);--primary:#2563eb;--primary-700:#1d4ed8;--text:#0f172a;--muted:#475569;--ok:#16a34a;--gold:#f59e0b;--shadow:0 18px 46px rgba(2,6,23,.20);--radius:22px;--transition:200ms ease}
    html[data-theme="dark"]{--glass:rgba(17,24,39,.46);--glass-strong:rgba(17,24,39,.62);--primary:#60a5fa;--primary-700:#3b82f6;--text:#e5e7eb;--muted:#94a3b8;--shadow:0 22px 56px rgba(0,0,0,.46)}
    html,body{height:100%} body{margin:0;color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#000}

    /* Calques fond (haut/bas trÃ¨s sÃ©parÃ©s) */
    .top,.top-night,.bottom,.bottom-night{
      position:fixed; inset:0; z-index:-2; background-size:cover; background-position:center; background-repeat:no-repeat;
    }
    /* SÃ©paration nette, fondu minime */
    .top,.top-night{
      -webkit-mask-image: linear-gradient(to bottom,#000 0,#000 62vh, rgba(0,0,0,.08) 65vh, rgba(0,0,0,0) 67vh);
              mask-image: linear-gradient(to bottom,#000 0,#000 62vh, rgba(0,0,0,.08) 65vh, rgba(0,0,0,0) 67vh);
    }
    .bottom,.bottom-night{
      -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0) 0, rgba(0,0,0,0) 60vh, rgba(0,0,0,.9) 68vh, #000 100%);
              mask-image: linear-gradient(to bottom, rgba(0,0,0,0) 0, rgba(0,0,0,0) 60vh, rgba(0,0,0,.9) 68vh, #000 100%);
    }

    html[data-theme="dark"] .top{opacity:0} html[data-theme="dark"] .top-night{opacity:1}
    html[data-theme="dark"] .bottom{opacity:0} html[data-theme="dark"] .bottom-night{opacity:1}

    /* Topbar */
    .topbar{position:sticky;top:0;z-index:5;display:flex;justify-content:space-between;align-items:center;gap:12px;padding:12px 18px;
      backdrop-filter: blur(10px) saturate(120%); background: color-mix(in oklab, rgba(0,0,0,.6) 60%, rgba(255,255,255,.18));
      border-bottom:1px solid rgba(255,255,255,.2)}
    .nav-left{display:flex;align-items:center;gap:16px}
    .logo{height:42px;border-radius:8px}
    .nav{display:flex;gap:10px;background: color-mix(in oklab, var(--glass) 84%, transparent); border:1px solid rgba(255,255,255,.45); padding:6px 10px; border-radius:999px}
    .nav a{ text-decoration:none; color:var(--text); font-weight:700; padding:6px 12px; border-radius:999px }
    .nav a[aria-current="page"], .nav a:hover{ background: rgba(255,255,255,.35) }
    .theme-toggle{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:9px 15px;color:#fff;font-weight:700;border:1px solid color-mix(in oklab,var(--primary) 35%,transparent);background:linear-gradient(180deg,var(--primary),var(--primary-700));cursor:pointer}

    /* Hero */
    .hero{ min-height: 64svh; display:grid; place-items:center; padding: clamp(16px,4vw,48px); text-align:center; color:#fff; text-shadow: 0 2px 22px rgba(0,0,0,.35) }
    .hero h1{ font-family:Poppins,system-ui,sans-serif; font-size: clamp(34px,6vw,64px); margin:0 0 8px }
    .sub{ font-size: clamp(14px,1.6vw,18px); color:#fff; opacity:.95 }

    /* Contenu */
    .wrap{ max-width:1200px; margin:0 auto; padding: clamp(12px,3vw,24px); display:grid; grid-template-columns: 1.1fr .9fr; gap: clamp(16px,2.4vw,28px) }
    @media (max-width:1080px){ .wrap{ grid-template-columns:1fr } }
    .panel{
      background:var(--glass); backdrop-filter: blur(10px) saturate(120%);
      border:1px solid rgba(255,255,255,.35); border-radius:var(--radius); box-shadow:var(--shadow);
      padding: clamp(18px,2.6vw,28px);
      will-change: transform, box-shadow;
    }
    .panel:hover{ transform: translateY(-2px); }
    h2{ font-family:Poppins,system-ui,sans-serif; margin:0 0 12px }
    .lead{ color:var(--muted); line-height:1.75; font-size: clamp(16px,1.3vw,18px) }
    .features{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 12px }
    @media (max-width: 900px){ .features{ grid-template-columns: repeat(2,1fr) } }
    @media (max-width: 560px){ .features{ grid-template-columns: 1fr } }
    .feature{ display:flex; align-items:center; gap:12px; padding:14px 16px; background: color-mix(in oklab, rgba(22,163,74,.40) 66%, var(--glass-strong)); border:1px solid color-mix(in oklab, var(--ok) 55%, transparent); border-radius:16px; }
    .feature:hover{ transform: translateY(-2px) scale(1.01); }
    .feature svg{ width:28px; height:28px; color: var(--ok); }
    .cta{ margin-top:12px; display:inline-flex; align-items:center; gap:10px; border-radius:12px; padding:12px 16px; color:#fff; font-weight:800; border:1px solid color-mix(in oklab, var(--primary) 35%, transparent); background: linear-gradient(180deg, var(--primary), var(--primary-700)); text-decoration:none }
    .cta:hover{ transform: translateY(-1px) scale(1.01) }

    .stars{ color: var(--gold); letter-spacing:2px; font-weight:700 }
  </style>
</head>
<body>
  <!-- Calques fond (images dÃ©finies via JS + fallback) -->
  <div class="top"    aria-hidden="true" id="bgTop"></div>
  <div class="top-night" aria-hidden="true" id="bgTopNight"></div>
  <div class="bottom" aria-hidden="true" id="bgBottom"></div>
  <div class="bottom-night" aria-hidden="true" id="bgBottomNight"></div>

  <header class="topbar">
    <div class="nav-left">
      <img src="logo.jpg" alt="Camping Rivassland" class="logo">
      <nav class="nav">
        <a href="accueil.html" aria-current="page">Accueil</a>
        <a href="reservation.html">RÃ©servations</a>
        <a href="index.html">Donner votre avis</a>
      </nav>
    </div>
    <button id="themeToggle" class="theme-toggle"><span id="themeIcon">ðŸŒž</span><span id="themeLabel">Mode clair</span></button>
  </header>

  <section class="hero">
    <div>
      <h1>Bienvenue Ã  Saint-Malo</h1>
      <div id="ratingLine" class="sub">Camping <span class="stars" aria-live="polite" aria-atomic="true">â˜…â˜…â˜…â˜…â˜…</span> chez lâ€™habitant</div>
    </div>
  </section>

  <main class="wrap">
    <section class="panel">
      <h2>Camping de Rivassland</h2>
      <p class="lead">Au cÅ“ur de ParamÃ©, Ã  quelques minutes de la mer et du centre-ville, terrain privÃ© de plus de 18 000 mÂ² entourÃ© de verdure.</p>
      <p class="lead">Ambiance dÃ©contractÃ©e, respectueuse et calme : lâ€™endroit idÃ©al pour faire une pause nature tout en restant proche de la ville.</p>
      <p class="lead">âœ¨ Sur place : emplacements spacieux (vans/tentes), piscine chauffÃ©e (juin â†’ septembre), cadre verdoyant pour se ressourcer.</p>
      <a class="cta" href="reservation.html">RÃ©server</a>
      <a class="cta" href="index.html" style="margin-left:8px;">Donner votre avis</a>
    </section>

    <section class="panel">
      <h2>Ã‰quipements & Services</h2>
      <div class="features">
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 3a1 1 0 0 0-1 1v7H3a1 1 0 1 0 0 2h3v2a4 4 0 0 0 4 4h1a1 1 0 1 0 0-2H10a2 2 0 0 1-2-2v-2h8v2a2 2 0 0 1-2 2h-1a1 1 0 1 0 0 2h1a4 4 0 0 0 4-4v-2h3a1 1 0 1 0 0-2h-3V4a1 1 0 0 0-1-1H7z"/></svg> Sanitaires</div>
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a1 1 0 0 1 1 1v8h3l-4 4-4-4h3V3a1 1 0 0 1 1-1zm-7 18a1 1 0 0 0 1 1h12a1 1 0 1 0 0-2H6a1 1 0 0 0-1 1z"/></svg> Vidange</div>
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 2h12a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm0 4h12V4H6v2zm6 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm-4-9h2V7H8v2z"/></svg> Laverie</div>
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 17c1.5 0 2-.8 3-1.2 1-.4 1.5-.8 3-.8s2 .4 3 .8 1.5 1.2 3 1.2 2-.8 3-1.2 1.5-.8 3-.8v2c-1.5 0-2 .4-3 .8s-1.5 1.2-3 1.2-2-.8-3-1.2-1.5-.8-3-.8-2 .4-3 .8S5.5 21 3 21v-2z"/></svg> Piscine</div>
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a2 2 0 0 1 2 2v6.17a3 3 0 1 1-2 0V4a2 2 0 0 1 2-2zm-8 16c1.5 0 2-.8 3-1.2 1-.4 1.5-.8 3-.8s2 .4 3 .8 1.5 1.2 3 1.2 2-.8 3-1.2 1.5-.8 3-.8v2c-1.5 0-2 .4-3 .8s-1.5 1.2-3 1.2-2-.8-3-1.2-1.5-.8-3-.8-2 .4-3 .8S5.5 21 4 21v-2z"/></svg> AccÃ¨s mer</div>
        <div class="feature"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a6 6 0 0 1 6 6c0 4.5-6 12-6 12S6 12.5 6 8a6 6 0 0 1 6-6zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg> Centre-ville</div>
      </div>
    </section>
  </main>

  <script>
    // ThÃ¨me
    (function(){
      const html=document.documentElement, saved=localStorage.getItem("theme");
      html.setAttribute("data-theme",(saved==="light"||saved==="dark")?saved:(matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));
      const btn=document.getElementById("themeToggle"), icon=document.getElementById("themeIcon"), label=document.getElementById("themeLabel");
      function u(){ const d=html.getAttribute("data-theme")==="dark"; icon.textContent=d?"ðŸŒ™":"ðŸŒž"; label.textContent=d?"Mode sombre":"Mode clair"; }
      btn.addEventListener("click",()=>{ const next=html.getAttribute("data-theme")==="dark"?"light":"dark"; html.setAttribute("data-theme",next); localStorage.setItem("theme",next); u(); });
      u();
    })();

    // PrÃ©-chargement avec fallback
    (async function setBackgrounds(){
      const bgTop = document.getElementById('bgTop');
      const bgTopNight = document.getElementById('bgTopNight');
      const bgBottom = document.getElementById('bgBottom');
      const bgBottomNight = document.getElementById('bgBottomNight');

      async function canLoad(src){
        return new Promise(res=>{
          const im=new Image(); im.onload=()=>res(true); im.onerror=()=>res(false); im.src=src+'?v='+Date.now();
        });
      }

      const TOP_DAY_PRIMARY   = 'accueil-haut-jour.jpg';
      const TOP_DAY_FALLBACK  = 'camping.jpg';
      const TOP_NIGHT_PRIMARY = 'accueil-nui.jpg';
      const TOP_NIGHT_FALLBACK= 'camping-nuit.jpg';

      const BOT_DAY           = 'camping-accueil-2.jpg';
      const BOT_NIGHT_PRIMARY = 'camping-accueil-nuit-2.jpg';
      const BOT_NIGHT_FALLBACK= 'camping-accueil-2.jpg';

      const topDay   = (await canLoad(TOP_DAY_PRIMARY))   ? TOP_DAY_PRIMARY   : TOP_DAY_FALLBACK;
      const topNight = (await canLoad(TOP_NIGHT_PRIMARY)) ? TOP_NIGHT_PRIMARY : TOP_NIGHT_FALLBACK;
      const botNight = (await canLoad(BOT_NIGHT_PRIMARY)) ? BOT_NIGHT_PRIMARY : BOT_NIGHT_FALLBACK;

      if(bgTop)        bgTop.style.backgroundImage = `url("${topDay}")`;
      if(bgTopNight)   bgTopNight.style.backgroundImage = `url("${topNight}")`;
      if(bgBottom)     bgBottom.style.backgroundImage = `url("${BOT_DAY}")`;
      if(bgBottomNight)bgBottomNight.style.backgroundImage = `url("${botNight}")`;
    })();

    // Moyenne des avis sous le titre
    (async function(){
      try{
        const r=await fetch("/api/gas");
        const data=await r.json();
        let notes=[], total=0;
        if(Array.isArray(data)){
          data.forEach(row=>{
            const nl=Number(row.noteLieu||row["Note lieu"]||row.note_lieu||0);
            const na=Number(row.noteAccueil||row["Note accueil"]||row.note_accueil||0);
            if(nl||na){ const m=(nl+na)/2; notes.push(m); total+=m; }
          });
        }
        const avg = notes.length ? (total/notes.length) : 0;
        const stars = 'â˜…'.repeat(Math.round(avg)) + 'â˜†'.repeat(5-Math.round(avg));
        const el=document.getElementById('ratingLine');
        if(el) el.innerHTML = `Camping <span class="stars" title="${avg.toFixed(1)}/5">${stars}</span> chez lâ€™habitant`;
      }catch(e){}
    })();
  </script>
</body>
</html>